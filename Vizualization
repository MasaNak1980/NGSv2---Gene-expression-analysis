Log fold change shrinkage for visualization and ranking

#apeglmをインストール


if (!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager")

BiocManager::install("apeglm")

resultsNames(dds_wt)
resLFC <- lfcShrink(dds_wt, coef="condition_Type_1_Diabetes_vs_Healthy_Control", type="apeglm")
resLFC

#作図
plotMA(resLFC, ylim=c(-2,2))

-------------------------------------------
Heatmap
library("pheatmap")
ntd <- normTransform(dds)
select <- order(rowMeans(counts(dds_wt,normalized=TRUE)),
                decreasing=TRUE)[1:20]
df <- as.data.frame(colData(dds_wt)[,c("condition")])
df
# rownames(annotation_c) <- colnames(ntd)
pheatmap(assay(ntd)[select,], cluster_rows=FALSE, show_rownames=FALSE,
         cluster_cols=FALSE, annotation_col=df)
エラーがでる         
Error in check.length("fill") : 
  'gpar' element 'fill' must not be length 0
         
         
